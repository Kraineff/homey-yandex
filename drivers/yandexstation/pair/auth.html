<script type="application/javascript">
    var url = "";
    Homey.emit("start").then((view => {
        if (view === "list_devices") {
            Homey.showView(view);
        } else {
            Homey.setTitle(Homey.__("auth.title"));
            document.getElementById("wrapper").style.display = "flex";
            url = view;

            let check = setInterval(() => {
                Homey.emit("check").then((result) => {
                    if (result) {
                        clearInterval(check);
                        Homey.showView("list_devices");
                    }
                });
            }, 5000);
        }
    }));

    function auth() {
        Homey.popup(url);
    }
</script>

<style type="text/css">
    #wrapper {
        display: none;
        flex-direction: column;
        width: 100%;
        height: 100%;
    }
</style>

<div id="wrapper">
    <p style="height: 100%;" data-i18n="auth.desc"></p>
    <button onclick="auth()" data-i18n="auth.button"></button>
</div>